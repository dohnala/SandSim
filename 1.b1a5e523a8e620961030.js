(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,,,,,,,,,function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return M})),n.d(t,"a",(function(){return C})),n.d(t,"b",(function(){return z})),n.d(t,"c",(function(){return P})),n.d(t,"f",(function(){return I})),n.d(t,"g",(function(){return T})),n.d(t,"e",(function(){return Y})),n.d(t,"h",(function(){return D})),n.d(t,"i",(function(){return X}));var r=n(10);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var u=new Array(32).fill(void 0);function c(e){return u[e]}u.push(void 0,null,!0,!1);var s=u.length;function l(e){var t=c(e);return function(e){e<36||(u[e]=s,s=e)}(e),t}var f=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});f.decode();var v=null;function h(){return null!==v&&v.buffer===r.ib.buffer||(v=new Uint8Array(r.ib.buffer)),v}function p(e,t){return f.decode(h().subarray(e,e+t))}function d(e,t){if(!(e instanceof t))throw new Error("expected instance of ".concat(t.name));return e.ptr}var m=null;function y(){return null!==m&&m.buffer===r.ib.buffer||(m=new Int32Array(r.ib.buffer)),m}var w=null;function g(){return null!==w&&w.buffer===r.ib.buffer||(w=new Float32Array(r.ib.buffer)),w}function k(e){return null==e}var _=0,x=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8"),b="function"==typeof x.encodeInto?function(e,t){return x.encodeInto(e,t)}:function(e,t){var n=x.encode(e);return t.set(n),{read:e.length,written:n.length}};var M=Object.freeze({EMPTY:0,0:"EMPTY",CAVE:1,1:"CAVE"}),C=Object.freeze({Empty:0,0:"Empty",Wall:1,1:"Wall",Sand:2,2:"Sand",Dirt:3,3:"Dirt",Water:4,4:"Water"}),E=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.a(e)}},{key:"x",value:function(){return r.f(this.ptr)}},{key:"y",value:function(){return r.V(this.ptr)}},{key:"active",value:function(){return 0!==r.T(this.ptr)}},{key:"active_next_tick",value:function(){return 0!==r.U(this.ptr)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}}]),e}(),z=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.t(e)}},{key:"insert",value:function(e,t,n,i){r.bb(this.ptr,e,t,n,i)}},{key:"clear",value:function(){r.Y(this.ptr)}},{key:"tick",value:function(){return r.gb(this.ptr)>>>0}},{key:"config",value:function(){var e=r.Z(this.ptr);return P.__wrap(e)}},{key:"display",value:function(){return r.ab(this.ptr)}},{key:"pixel_info",value:function(e,t){var n=r.fb(this.ptr,e,t);return 0===n?void 0:S.__wrap(n)}},{key:"chunks_count",value:function(){return r.X(this.ptr)>>>0}},{key:"chunk",value:function(e){var t=r.W(this.ptr,e);return E.__wrap(t)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new_empty",value:function(t){d(t,P);var n=t.ptr;t.ptr=0;var i=r.eb(n);return e.__wrap(i)}},{key:"new_cave",value:function(t){d(t,P);var n=t.ptr;t.ptr=0;var i=r.db(n);return e.__wrap(i)}},{key:"new",value:function(t,n){d(t,P);var i=t.ptr;t.ptr=0;var a=r.cb(i,n);return e.__wrap(a)}}]),e}(),P=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.u(e)}},{key:"size",get:function(){return r.f(this.ptr)},set:function(e){r.B(this.ptr,e)}},{key:"gravity",get:function(){return r.c(this.ptr)},set:function(e){r.y(this.ptr,e)}},{key:"max_velocity",get:function(){return r.d(this.ptr)},set:function(e){r.z(this.ptr,e)}},{key:"use_chunks",get:function(){return 0!==r.g(this.ptr)},set:function(e){r.C(this.ptr,e)}},{key:"chunk_size",get:function(){return r.b(this.ptr)},set:function(e){r.x(this.ptr,e)}},{key:"seed",get:function(){return r.e(this.ptr)},set:function(e){r.A(this.ptr,e)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(t,n,i,a,o,u){var c=r.hb(t,n,i,a,o,u);return e.__wrap(c)}}]),e}(),S=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.w(e)}},{key:"element",get:function(){return r.l(this.ptr)>>>0},set:function(e){r.H(this.ptr,e)}},{key:"friction",get:function(){try{var e=r.P(-16);r.n(e,this.ptr);var t=y()[e/4+0],n=g()[e/4+1];return 0===t?void 0:n}finally{r.P(16)}},set:function(e){r.J(this.ptr,!k(e),k(e)?0:e)}},{key:"restitution",get:function(){try{var e=r.P(-16);r.q(e,this.ptr);var t=y()[e/4+0],n=g()[e/4+1];return 0===t?void 0:n}finally{r.P(16)}},set:function(e){r.M(this.ptr,!k(e),k(e)?0:e)}},{key:"inertia",get:function(){try{var e=r.P(-16);r.o(e,this.ptr);var t=y()[e/4+0],n=g()[e/4+1];return 0===t?void 0:n}finally{r.P(16)}},set:function(e){r.K(this.ptr,!k(e),k(e)?0:e)}},{key:"velocity_x",get:function(){try{var e=r.P(-16);r.r(e,this.ptr);var t=y()[e/4+0],n=g()[e/4+1];return 0===t?void 0:n}finally{r.P(16)}},set:function(e){r.N(this.ptr,!k(e),k(e)?0:e)}},{key:"velocity_y",get:function(){try{var e=r.P(-16);r.s(e,this.ptr);var t=y()[e/4+0],n=g()[e/4+1];return 0===t?void 0:n}finally{r.P(16)}},set:function(e){r.O(this.ptr,!k(e),k(e)?0:e)}},{key:"falling",get:function(){var e=r.m(this.ptr);return 16777215===e?void 0:0!==e},set:function(e){r.I(this.ptr,k(e)?16777215:e?1:0)}},{key:"not_moved_count",get:function(){var e=r.p(this.ptr);return 16777215===e?void 0:e},set:function(e){r.L(this.ptr,k(e)?16777215:e)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}}]),e}(),I=function(){return function(e){s===u.length&&u.push(u.length+1);var t=s;return s=u[t],u[t]=e,t}(new Error)},T=function(e,t){var n=function(e,t,n){if(void 0===n){var r=x.encode(e),i=t(r.length);return h().subarray(i,i+r.length).set(r),_=r.length,i}for(var a=e.length,o=t(a),u=h(),c=0;c<a;c++){var s=e.charCodeAt(c);if(s>127)break;u[o+c]=s}if(c!==a){0!==c&&(e=e.slice(c)),o=n(o,a,a=c+3*e.length);var l=h().subarray(o+c,o+a);c+=b(e,l).written}return _=c,o}(c(t).stack,r.R,r.S),i=_;y()[e/4+1]=i,y()[e/4+0]=n},Y=function(e,t){try{console.error(p(e,t))}finally{r.Q(e,t)}},D=function(e){l(e)},X=function(e,t){throw new Error(p(e,t))}}).call(this,n(12)(e))},function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(9);r.jb()},,,,,function(e,t){e.exports="precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\n\nvoid main() {\n    uv = position;\n    gl_Position = vec4(position, 0, 1);\n}"},function(e,t){e.exports="precision highp float;\n#define GLSLIFY 1\nuniform sampler2D map_texture;\nuniform sampler2D element_texture;\nuniform int element_count;\nvarying vec2 uv;\n\n// clang-format off\nvec3 hsv2rgb(vec3 c) {\n  vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n  vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n  return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid main() {\n    vec2 textCoord = (uv * vec2(0.5, -0.5)) + vec2(0.5);\n    vec4 pixel_info = texture2D(map_texture, textCoord);\n    int element = int((pixel_info.r * 255.) + 0.1);\n\n    // Color is in HSV + A format (x = h, y = s, z = v, w = a)\n    vec4 color = texture2D(element_texture, vec2(float(element)/float(element_count),0));\n\n    // Convert the color to RGBA\n    gl_FragColor = vec4(hsv2rgb(vec3(color.xyz)), color.w);\n}"},function(e,t){e.exports="precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nuniform float scale;\nuniform vec2 offset;\n\nvoid main () {\n    vec2 p  = position;\n    p *= scale;\n    p += offset;\n    gl_Position = vec4(p, 0, 1);\n}"},function(e,t){e.exports="precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\n\nvoid main () {\n    gl_FragColor = color;\n}"},function(e,t,n){"use strict";n.r(t),n.d(t,"canvas",(function(){return xe})),n.d(t,"config",(function(){return _e})),n.d(t,"map",(function(){return te})),n.d(t,"createMap",(function(){return be})),n.d(t,"nextTick",(function(){return Me})),n.d(t,"generateSeed",(function(){return ke}));var r=n(9),i=[{key:r.a.Empty,value:{name:"Empty",hsv:[0,0,1],alpha:0}},{key:r.a.Wall,value:{name:"Wall",hsv:[0,0,0],alpha:1}},{key:r.a.Sand,value:{name:"Sand",hsv:[46,.35,.62],alpha:1}},{key:r.a.Dirt,value:{name:"Dirt",hsv:[18,.69,.3],alpha:1}},{key:r.a.Water,value:{name:"Water",hsv:[222,.79,.54],alpha:.5}}],a=[64,128,256,512],o=[16,32,64],u=[{key:r.d.EMPTY,value:{name:"Empty"}},{key:r.d.CAVE,value:{name:"Cave"}}],c=function(){var e=[];for(var t in i)i.hasOwnProperty(t)&&(e=e.concat([i[t].value.hsv[0]/360],[i[t].value.hsv[1]],[i[t].value.hsv[2]],[i[t].value.alpha]));return e},s=document.getElementById("fps"),l=document.getElementById("meanRenderTime"),f=document.getElementById("meanTickTime"),v=document.getElementById("lastTickTime"),h=document.getElementById("meanPixelsProcessed"),p=document.getElementById("lastPixelsProcessed"),d={mean:0,delta:0,frames:[],lastFrameTimeStamp:performance.now(),measure:function(){var e=performance.now(),t=e-this.lastFrameTimeStamp;this.lastFrameTimeStamp=e;var n=1/t*1e3;this.delta=t/1e3,this.frames.push(n),this.frames.length>100&&this.frames.shift(),this.mean=g(this.frames)}},m={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){if(!window.paused){var e=performance.now()-this.startTime;this.last=e,this.frames.push(e),this.frames.length>100&&this.frames.shift(),this.mean=g(this.frames)}}},y={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){var e=performance.now()-this.startTime;this.last=e,v.textContent=window.paused?"".concat(Math.round(this.last),"ms"):"",this.frames.push(e),this.frames.length>100&&this.frames.shift(),this.mean=g(this.frames)}},w={mean:0,last:0,frames:[],measure:function(e){this.last=e,p.textContent=window.paused?"".concat(Math.round(this.last)," \n        (").concat(k(this.last,_e.size*_e.size),"%)"):"",this.frames.push(e),this.frames.length>10&&this.frames.shift(),this.mean=g(this.frames)},reset:function(){this.mean=0,this.last=0,this.frames=[]}},g=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length},k=function(e,t){return Math.round(100*e/t)};setInterval((function(){s.textContent="FPS: ".concat(Math.round(d.mean)),l.textContent="".concat(Math.round(m.mean),"ms"),f.textContent="".concat(Math.round(y.mean),"ms"),h.textContent="".concat(Math.round(w.mean)," \n    (").concat(k(Math.round(w.mean),_e.size*_e.size),"%)")}),100);var _=n(13),x=document.getElementById("canvas");_("document").ready((function(){I(),T(),Y(),N(),S()}));var b=_("#create"),M=_("#generateSeed"),C=_("#configUseChunks"),E=_("#configChunkSize"),z=!1,P=_("#showActiveChunks");b.click((function(){_e.size=Number(_("#configSize").val()),_e.gravity=ve(_("#configGravity").val(),-1,1),_e.maxVelocity=ve(_("#configMaxVelocity").val(),0,100),_e.useChunks=C.is(":checked"),_e.chunkSize=Number(E.val()),_e.generator=function(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t].value.name===e)return t;return null}(_("#configGenerator").val()),_e.seed=Number(_("#seed").val()),be(),S()})),M.click((function(){_e.seed=ke(),S()}));var S=function(){_("#configSize").val(_e.size),_("#configGravity").val(_e.gravity),_("#configMaxVelocity").val(_e.maxVelocity),_("#configGenerator").val(u[_e.generator].value.name),_("#seed").val(_e.seed),C.prop("checked",_e.useChunks),E.val(_e.chunkSize),E.prop("disabled",!_e.useChunks)},I=function(){a.forEach((function(e){var t="<option>".concat(e,"</option>");_("#configSize").append(t)}))},T=function(){o.forEach((function(e){var t="<option>".concat(e,"</option>");_("#configChunkSize").append(t)}))},Y=function(){for(var e in u)if(u.hasOwnProperty(e)){var t="<option>".concat(u[e].value.name,"</option>");_("#configGenerator").append(t)}};C.change((function(){E.prop("disabled",!this.checked),P.prop("disabled",!this.checked)})),P.change((function(){z=this.checked}));var D=!1,X=_("#play"),F=_("#pause"),A=_("#nextFrame"),O=_("#reset");X.hide(),A.addClass("disabled"),X.click((function(){return R()})),F.click((function(){return R()})),A.click((function(){return V()})),O.click((function(){return L()})),_("body").keypress((function(e){112===e.keyCode?R():102===e.keyCode?V():114===e.keyCode&&L()}));var R=function(){D=!D,window.paused=D,D?(X.show(),F.hide(),A.removeClass("disabled")):(X.hide(),F.show(),A.addClass("disabled"))},V=function(){D&&(y.start(),w.measure(Me()),y.stop())},L=function(){te.clear(),w.reset()},B=null,G=function(e){var t,n,r,a;return"rgb("+(t=i[e].value.hsv[0],n=i[e].value.hsv[1],r=i[e].value.hsv[2],[255*(a=function(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:(e+t/60)%6;return r-r*n*Math.max(Math.min(i,4-i,1),0)})(5),255*a(3),255*a(1)]).join(",")+")"},N=function(){var e=function(e){if(i.hasOwnProperty(e)){var t='\n                <div class="form-check">\n                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="element_'.concat(e,'">\n                    <label class="form-check-label" for="element_').concat(e,'">\n                        <i class="bi bi-square-fill" style="color: ').concat(G(e),'"></i>\n                        <label>').concat(i[e].value.name,"</label>\n                    </label>\n                </div>");_("#painting").append(t),_("#element_"+e).change((function(){return B=Number(e)}))}};for(var t in i)e(t);B=2,_("#element_2").attr("checked",!0)},W={value:0,step:1,min:0,max:5},j=_("#brushSize");j.on("change",(function(){W.value=ve(Number(_(this).val()),W.min,W.max)})),_(window).bind("mousewheel DOMMouseScroll",(function(e){e.originalEvent.wheelDelta>0||e.originalEvent.detail<0?(W.value=ve(W.value+W.step,W.min,W.max),j.val(W.value)):(W.value=ve(W.value-W.step,W.min,W.max),j.val(W.value))}));var q=null,K=!1,U=null,J=_("#inspectCheck"),H=_("#inspectDetails");H.hide(),J.click((function(){J.prop("checked")?(K=!0,clearInterval(U),U=window.setInterval((function(){return Q()}),100)):(K=!1,clearInterval(U))}));var Q=function(){if(K&&q){var e=te.pixel_info(q[0],q[1]);e&&(H.show(),_("#inspectElement").text(i[e.element].value.name),_("#inspectPosition").text("("+q[0]+", "+q[1]+")"),void 0!==e.velocity_x&&void 0!==e.velocity_y?(_("#inspectVelocity").text("("+e.velocity_x+", "+e.velocity_y+")"),_("#inspectVelocityRow").show()):_("#inspectVelocityRow").hide(),void 0!==e.falling?(_("#inspectFalling").text(e.falling),_("#inspectFallingRow").show()):_("#inspectFallingRow").hide(),void 0!==e.not_moved_count?(_("#inspectNotMovedCount").text(e.not_moved_count),_("#inspectNotMovedCountRow").show()):_("#inspectNotMovedCountRow").hide())}else H.hide()},Z=!1,$=null,ee=null;x.addEventListener("mousedown",(function(e){e.preventDefault(),Z=!0,clearInterval(ee),ee=window.setInterval((function(){return re(e)}),100),re(e),$=e})),document.body.addEventListener("mouseup",(function(e){clearInterval(ee),Z&&(e.preventDefault(),$=null,Z=!1)})),x.addEventListener("mousemove",(function(e){clearInterval(ee),ie(e),function(e){q=J.prop("checked")?ae(e):null}(e)})),x.addEventListener("mouseleave",(function(){clearInterval(ee),$=null,q=null}));var te,ne,re=function(e){if(Z){var t=ae(e);te.insert(t[0],t[1],B,W.value)}},ie=function(e){clearInterval(ee),ee=window.setInterval((function(){return re(e)}),100);var t={clientX:e.clientX,clientY:e.clientY};if(Z){var n=0;if(re(t),$)for(;oe(t,$)>1/3;){var r=oe(t,$);if(t=ue(t,le(se(ce($,e)),Math.min(1/3,r))),++n>1e3)break;re(t)}$=e}},ae=function(e){var t=x.getBoundingClientRect(),n=x.width/Math.ceil(window.devicePixelRatio)/t.width,r=x.height/Math.ceil(window.devicePixelRatio)/t.height,i=(e.clientX-t.left)*n,a=(e.clientY-t.top)*r;return[Math.max(Math.min(Math.floor(i),_e.size-1),0),Math.max(Math.min(Math.floor(a),_e.size-1),0)]},oe=function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2),2)},ue=function(e,t){return{clientX:e.clientX+t.clientX,clientY:e.clientY+t.clientY}},ce=function(e,t){return{clientX:e.clientX-t.clientX,clientY:e.clientY-t.clientY}},se=function(e){var t=fe(e);return{clientX:e.clientX/t,clientY:e.clientY/t}},le=function(e,t){return{clientX:e.clientX*t,clientY:e.clientY*t}},fe=function(e){return Math.sqrt(Math.pow(e.clientX,2)+Math.pow(e.clientY,2),2)},ve=function(e,t,n){return Math.min(Math.max(e,t),n)},he=n(10),pe=n(14),de=n(15),me=n(16),ye=n(17),we=n(18),ge=function(e){var t=e.canvas,n=e.map,r=e.config,a=pe({extensions:["OES_texture_float"],canvas:t}),o=n.config().size,u=a.texture({width:i.length,height:1,type:"float",data:c()}),s=a.texture({width:o,height:o,data:new Uint8Array(he.ib.buffer,n.display(),o*o*4)}),l=a({vert:de,frag:me,uniforms:{element_texture:u,element_count:i.length,map_texture:function(){return s({width:o,height:o,data:new Uint8Array(he.ib.buffer,n.display(),o*o*4)})}},attributes:{position:[[-1,4],[-1,-1],[4,-1]]},count:3}),f=a({vert:ye,frag:we,attributes:{position:[[-1,-1],[1,-1],[1,1],[-1,1]]},uniforms:{color:[0,1,0,.5],scale:a.prop("scale"),offset:a.prop("offset")},count:4,lineWidth:1,primitive:"line loop"}),v=function(){var e=[];if(r.useChunks)for(var t=r.chunkSize/o,i=0;i<n.chunks_count();i++){var a=n.chunk(i);e.push({scale:t,offset:[-1+t+a.x()/r.size*2,1-t-a.y()/r.size*2]})}return e}(),h=function(){r.useChunks&&z&&f(v.filter((function(e,t){return n.chunk(t).active_next_tick()})))};return function(){a.poll(),h(),l()}},ke=function(){return Math.floor(Math.random()*Math.floor(1e4))},_e={size:256,gravity:.2,maxVelocity:10,useChunks:!0,chunkSize:32,generator:r.d.EMPTY,seed:1},xe=document.getElementById("canvas"),be=function(){te=r.b.new(r.c.new(_e.size,_e.gravity,_e.maxVelocity,_e.useChunks,_e.chunkSize,_e.seed),Number(_e.generator)),xe.width=_e.size*Math.ceil(window.devicePixelRatio),xe.height=_e.size*Math.ceil(window.devicePixelRatio),ne=ge({canvas:xe,map:te,config:_e}),w.reset()};be();var Me=function(){return te.tick(d.delta)};!function e(){d.measure(),window.paused||(y.start(),w.measure(Me()),y.stop()),m.start(),ne(),m.stop(),window.animationId=requestAnimationFrame(e)}()}]]);
//# sourceMappingURL=1.b1a5e523a8e620961030.js.map