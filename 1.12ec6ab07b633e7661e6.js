(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{10:function(t,n,e){"use strict";var r=e.w[t.i];t.exports=r;e(9);r.z()},15:function(t,n,e){"use strict";e.r(n),e.d(n,"canvas",(function(){return R})),e.d(n,"config",(function(){return q})),e.d(n,"map",(function(){return C})),e.d(n,"createMap",(function(){return W})),e.d(n,"nextTick",(function(){return L}));var r=e(9),i=e(10),a=e(12),o=document.getElementById("fps"),c=document.getElementById("meanFrameTime"),u=document.getElementById("meanRenderTime"),l=document.getElementById("meanTickTime"),f=document.getElementById("lastTickTime"),s={mean:0,delta:0,frames:[],lastFrameTimeStamp:performance.now(),measure:function(){var t=performance.now(),n=t-this.lastFrameTimeStamp;this.lastFrameTimeStamp=t;var e=1/n*1e3;this.delta=n/1e3,this.frames.push(e),this.frames.length>100&&this.frames.shift(),this.mean=m(this.frames)}},h={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){if(!window.paused){var t=performance.now()-this.startTime;this.last=t,this.frames.push(t),this.frames.length>100&&this.frames.shift(),this.mean=m(this.frames)}}},v={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){if(!window.paused){var t=performance.now()-this.startTime;this.last=t,this.frames.push(t),this.frames.length>100&&this.frames.shift(),this.mean=m(this.frames)}}},d={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){var t=performance.now()-this.startTime;this.last=t,f.textContent=window.paused?"".concat(Math.round(this.last),"ms"):"",this.frames.push(t),this.frames.length>100&&this.frames.shift(),this.mean=m(this.frames)}},m=function(t){for(var n=0,e=0;e<t.length;e++)n+=t[e];return n/t.length};setInterval((function(){o.textContent="FPS: ".concat(Math.round(s.mean)),c.textContent="".concat(Math.round(h.mean),"ms"),u.textContent="".concat(Math.round(v.mean),"ms"),l.textContent="".concat(Math.round(d.mean),"ms")}),500);var p=e(14),w=document.getElementById("canvas"),y=r.a.Sand,g=!1,k=p("#create"),x=p("#play"),b=p("#pause"),_=p("#nextFrame");x.hide(),_.addClass("disabled"),p("document").ready((function(){M()})),k.click((function(){q.width=P(p("#configWidth").val(),64,512),q.height=P(p("#configHeight").val(),64,512),q.gravity=P(p("#configGravity").val(),-1,1),q.max_velocity=P(p("#configMaxVelocity").val(),0,100),W(),M()})),x.click((function(){return T()})),b.click((function(){return T()})),_.click((function(){g&&(d.start(),L(),d.stop())})),p("#reset").click((function(){return C.clear()}));var M=function(){p("#configWidth").val(q.width),p("#configHeight").val(q.height),p("#configGravity").val(q.gravity),p("#configMaxVelocity").val(q.max_velocity)},T=function(){g=!g,window.paused=g,g?(x.show(),b.hide(),_.removeClass("disabled")):(x.hide(),b.show(),_.addClass("disabled"))};p("#emptyElement").change((function(){return y=r.a.Empty})),p("#wallElement").change((function(){return y=r.a.Wall})),p("#sandElement").change((function(){return y=r.a.Sand}));var E=!1,I=null,X=null;w.addEventListener("mousedown",(function(t){t.preventDefault(),E=!0,clearInterval(X),X=window.setInterval((function(){return Y(t)}),100),Y(t),I=t})),document.body.addEventListener("mouseup",(function(t){clearInterval(X),E&&(t.preventDefault(),I=null,E=!1)})),w.addEventListener("mousemove",(function(t){clearInterval(X),function(t){clearInterval(X),X=window.setInterval((function(){return Y(t)}),100);var n={clientX:t.clientX,clientY:t.clientY};if(!E)return;var e=0;if(Y(n),I)for(;F(n,I)>1/3;){var r=F(n,I);if(n=S(n,D(A(j(I,t)),Math.min(1/3,r))),++e>1e3)break;Y(n)}I=t}(t)})),w.addEventListener("mouseleave",(function(t){clearInterval(X),I=null}));var Y=function(t){if(E){var n=w.getBoundingClientRect(),e=w.width/Math.ceil(window.devicePixelRatio)/n.width,r=w.height/Math.ceil(window.devicePixelRatio)/n.height,i=(t.clientX-n.left)*e,a=(t.clientY-n.top)*r,o=Math.min(Math.floor(i),q.width-1),c=Math.min(Math.floor(a),q.height-1);C.insert(o,c,y)}};var C,B,F=function(t,n){return Math.sqrt(Math.pow(t.clientX-n.clientX,2)+Math.pow(t.clientY-n.clientY,2),2)},S=function(t,n){return{clientX:t.clientX+n.clientX,clientY:t.clientY+n.clientY}},j=function(t,n){return{clientX:t.clientX-n.clientX,clientY:t.clientY-n.clientY}},A=function(t){var n=O(t);return{clientX:t.clientX/n,clientY:t.clientY/n}},D=function(t,n){return{clientX:t.clientX*n,clientY:t.clientY*n}},O=function(t){return Math.sqrt(Math.pow(t.clientX,2)+Math.pow(t.clientY,2),2)},P=function(t,n,e){return Math.min(Math.max(t,n),e)},q={width:128,height:128,gravity:.2,max_velocity:5},R=document.getElementById("canvas"),W=function(){var t,n,e,o,c,u,l,f,s,h;C=r.b.new(r.c.new(q.width,q.height,q.gravity,q.max_velocity)),R.width=q.width*Math.ceil(window.devicePixelRatio),R.height=q.height*Math.ceil(window.devicePixelRatio),n=(t={canvas:R,map:C}).canvas,e=t.map,o=a({canvas:n}),c=e.width(),u=e.height(),l=e.pixels(),f=new Uint8Array(i.s.buffer,l,c*u*4),s=o.texture({width:c,height:u,data:f}),h=o({frag:"\n        precision highp float;\n        uniform sampler2D data;\n        varying vec2 uv;\n        void main() {\n            vec2 textCoord = (uv * vec2(0.5, -0.5)) + vec2(0.5);\n            vec4 data = texture2D(data, textCoord);\n            int element = int((data.r * 255.) + 0.1);\n            vec4 color;\n            \n            // empty\n            if (element == 0) {\n                color = vec4(255, 255, 255, 1);\n            }\n            \n            if (element == 1) {\n                color = vec4(0, 0, 0, 1);\n            }\n            \n            // sand\n            if (element == 2) {\n                color = vec4(0.76, 0.7, 0.5, 1);\n            }\n            \n            gl_FragColor = color;\n        }",vert:"\n        precision mediump float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n            uv = position;\n            gl_Position = vec4(position, 0, 1);\n        }",uniforms:{data:function(){return l=e.pixels(),f=new Uint8Array(i.s.buffer,l,c*u*4),s({width:c,height:u,data:f})}},attributes:{position:[[-1,4],[-1,-1],[4,-1]]},count:3}),B=function(){o.poll(),h()}};W();var L=function(){C.tick(s.delta)};!function t(){s.measure(),h.start(),window.paused||(d.start(),L(),d.stop()),v.start(),B(),v.stop(),h.stop(),window.animationId=requestAnimationFrame(t)}()},9:function(t,n,e){"use strict";(function(t){e.d(n,"a",(function(){return k})),e.d(n,"b",(function(){return x})),e.d(n,"c",(function(){return b})),e.d(n,"e",(function(){return T})),e.d(n,"f",(function(){return E})),e.d(n,"d",(function(){return I})),e.d(n,"g",(function(){return X})),e.d(n,"h",(function(){return Y}));var r=e(10);function i(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function a(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,n,e){return n&&a(t.prototype,n),e&&a(t,e),t}var c=new Array(32).fill(void 0);function u(t){return c[t]}c.push(void 0,null,!0,!1);var l=c.length;function f(t){var n=u(t);return function(t){t<36||(c[t]=l,l=t)}(t),n}var s=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});s.decode();var h=null;function v(){return null!==h&&h.buffer===r.s.buffer||(h=new Uint8Array(r.s.buffer)),h}function d(t,n){return s.decode(v().subarray(t,t+n))}var m=0,p=new("undefined"==typeof TextEncoder?(0,t.require)("util").TextEncoder:TextEncoder)("utf-8"),w="function"==typeof p.encodeInto?function(t,n){return p.encodeInto(t,n)}:function(t,n){var e=p.encode(t);return n.set(e),{read:t.length,written:e.length}};var y=null;function g(){return null!==y&&y.buffer===r.s.buffer||(y=new Int32Array(r.s.buffer)),y}var k=Object.freeze({Empty:0,0:"Empty",Wall:1,1:"Wall",Sand:2,2:"Sand"}),x=function(){function t(){i(this,t)}return o(t,[{key:"free",value:function(){var t=this.ptr;this.ptr=0,r.a(t)}},{key:"insert",value:function(t,n,e){r.k(this.ptr,t,n,e)}},{key:"clear",value:function(){r.h(this.ptr)}},{key:"tick",value:function(){r.p(this.ptr)}},{key:"width",value:function(){return r.q(this.ptr)}},{key:"height",value:function(){return r.j(this.ptr)}},{key:"generation",value:function(){return r.i(this.ptr)}},{key:"pixels",value:function(){return r.o(this.ptr)}},{key:"pixel",value:function(t,n){var e=r.m(this.ptr,t,n);return _.__wrap(e)}},{key:"pixel_state",value:function(t,n){var e=r.n(this.ptr,t,n);return M.__wrap(e)}}],[{key:"__wrap",value:function(n){var e=Object.create(t.prototype);return e.ptr=n,e}},{key:"new",value:function(n){!function(t,n){if(!(t instanceof n))throw new Error("expected instance of ".concat(n.name));t.ptr}(n,b);var e=n.ptr;n.ptr=0;var i=r.l(e);return t.__wrap(i)}}]),t}(),b=function(){function t(){i(this,t)}return o(t,[{key:"free",value:function(){var t=this.ptr;this.ptr=0,r.b(t)}}],[{key:"__wrap",value:function(n){var e=Object.create(t.prototype);return e.ptr=n,e}},{key:"new",value:function(n,e,i,a){var o=r.r(n,e,i,a);return t.__wrap(o)}}]),t}(),_=function(){function t(){i(this,t)}return o(t,[{key:"free",value:function(){var t=this.ptr;this.ptr=0,r.c(t)}},{key:"element",value:function(){return r.t(this.ptr)>>>0}}],[{key:"__wrap",value:function(n){var e=Object.create(t.prototype);return e.ptr=n,e}},{key:"new",value:function(n){var e=r.u(n);return t.__wrap(e)}}]),t}(),M=function(){function t(){i(this,t)}return o(t,[{key:"free",value:function(){var t=this.ptr;this.ptr=0,r.d(t)}},{key:"element",value:function(){return r.w(this.ptr)>>>0}},{key:"velocity_y",value:function(){return r.y(this.ptr)}},{key:"clock_flag",value:function(){return 0!==r.v(this.ptr)}}],[{key:"__wrap",value:function(n){var e=Object.create(t.prototype);return e.ptr=n,e}},{key:"new",value:function(n){var e=r.x(n);return t.__wrap(e)}}]),t}(),T=function(){return function(t){l===c.length&&c.push(c.length+1);var n=l;return l=c[n],c[n]=t,n}(new Error)},E=function(t,n){var e=function(t,n,e){if(void 0===e){var r=p.encode(t),i=n(r.length);return v().subarray(i,i+r.length).set(r),m=r.length,i}for(var a=t.length,o=n(a),c=v(),u=0;u<a;u++){var l=t.charCodeAt(u);if(l>127)break;c[o+u]=l}if(u!==a){0!==u&&(t=t.slice(u)),o=e(o,a,a=u+3*t.length);var f=v().subarray(o+u,o+a);u+=w(t,f).written}return m=u,o}(u(n).stack,r.f,r.g),i=m;g()[t/4+1]=i,g()[t/4+0]=e},I=function(t,n){try{console.error(d(t,n))}finally{r.e(t,n)}},X=function(t){f(t)},Y=function(t,n){throw new Error(d(t,n))}}).call(this,e(13)(t))}}]);
//# sourceMappingURL=1.12ec6ab07b633e7661e6.js.map