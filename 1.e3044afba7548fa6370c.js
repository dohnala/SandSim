(window.webpackJsonp=window.webpackJsonp||[]).push([[1],[,,,,,,,,,function(t,e,n){"use strict";(function(t){n.d(e,"d",(function(){return M})),n.d(e,"a",(function(){return C})),n.d(e,"b",(function(){return z})),n.d(e,"c",(function(){return P})),n.d(e,"f",(function(){return S})),n.d(e,"g",(function(){return T})),n.d(e,"e",(function(){return Y})),n.d(e,"h",(function(){return D})),n.d(e,"i",(function(){return X}));var r=n(10);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function a(t,e,n){return e&&o(t.prototype,e),n&&o(t,n),t}var u=new Array(32).fill(void 0);function c(t){return u[t]}u.push(void 0,null,!0,!1);var s=u.length;function l(t){var e=c(t);return function(t){t<36||(u[t]=s,s=t)}(t),e}var f=new("undefined"==typeof TextDecoder?(0,t.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});f.decode();var v=null;function h(){return null!==v&&v.buffer===r.ib.buffer||(v=new Uint8Array(r.ib.buffer)),v}function p(t,e){return f.decode(h().subarray(t,t+e))}function d(t,e){if(!(t instanceof e))throw new Error("expected instance of ".concat(e.name));return t.ptr}var m=null;function y(){return null!==m&&m.buffer===r.ib.buffer||(m=new Int32Array(r.ib.buffer)),m}var w=null;function g(){return null!==w&&w.buffer===r.ib.buffer||(w=new Float32Array(r.ib.buffer)),w}function k(t){return null==t}var _=0,b=new("undefined"==typeof TextEncoder?(0,t.require)("util").TextEncoder:TextEncoder)("utf-8"),x="function"==typeof b.encodeInto?function(t,e){return b.encodeInto(t,e)}:function(t,e){var n=b.encode(t);return e.set(n),{read:t.length,written:n.length}};var M=Object.freeze({EMPTY:0,0:"EMPTY",CAVE:1,1:"CAVE"}),C=Object.freeze({Empty:0,0:"Empty",Wall:1,1:"Wall",Sand:2,2:"Sand",Dirt:3,3:"Dirt",Water:4,4:"Water"}),E=function(){function t(){i(this,t)}return a(t,[{key:"__destroy_into_raw",value:function(){var t=this.ptr;return this.ptr=0,t}},{key:"free",value:function(){var t=this.__destroy_into_raw();r.a(t)}},{key:"x",value:function(){return r.f(this.ptr)}},{key:"y",value:function(){return r.V(this.ptr)}},{key:"active",value:function(){return 0!==r.T(this.ptr)}},{key:"active_next_tick",value:function(){return 0!==r.U(this.ptr)}}],[{key:"__wrap",value:function(e){var n=Object.create(t.prototype);return n.ptr=e,n}}]),t}(),z=function(){function t(){i(this,t)}return a(t,[{key:"__destroy_into_raw",value:function(){var t=this.ptr;return this.ptr=0,t}},{key:"free",value:function(){var t=this.__destroy_into_raw();r.t(t)}},{key:"insert",value:function(t,e,n,i){r.bb(this.ptr,t,e,n,i)}},{key:"clear",value:function(){r.Y(this.ptr)}},{key:"tick",value:function(){return r.gb(this.ptr)>>>0}},{key:"config",value:function(){var t=r.Z(this.ptr);return P.__wrap(t)}},{key:"display",value:function(){return r.ab(this.ptr)}},{key:"pixel_info",value:function(t,e){var n=r.fb(this.ptr,t,e);return 0===n?void 0:I.__wrap(n)}},{key:"chunks_count",value:function(){return r.X(this.ptr)>>>0}},{key:"chunk",value:function(t){var e=r.W(this.ptr,t);return E.__wrap(e)}}],[{key:"__wrap",value:function(e){var n=Object.create(t.prototype);return n.ptr=e,n}},{key:"new_empty",value:function(e){d(e,P);var n=e.ptr;e.ptr=0;var i=r.eb(n);return t.__wrap(i)}},{key:"new_cave",value:function(e){d(e,P);var n=e.ptr;e.ptr=0;var i=r.db(n);return t.__wrap(i)}},{key:"new",value:function(e,n){d(e,P);var i=e.ptr;e.ptr=0;var o=r.cb(i,n);return t.__wrap(o)}}]),t}(),P=function(){function t(){i(this,t)}return a(t,[{key:"__destroy_into_raw",value:function(){var t=this.ptr;return this.ptr=0,t}},{key:"free",value:function(){var t=this.__destroy_into_raw();r.u(t)}},{key:"size",get:function(){return r.f(this.ptr)},set:function(t){r.B(this.ptr,t)}},{key:"gravity",get:function(){return r.c(this.ptr)},set:function(t){r.y(this.ptr,t)}},{key:"max_velocity",get:function(){return r.d(this.ptr)},set:function(t){r.z(this.ptr,t)}},{key:"use_chunks",get:function(){return 0!==r.g(this.ptr)},set:function(t){r.C(this.ptr,t)}},{key:"chunk_size",get:function(){return r.b(this.ptr)},set:function(t){r.x(this.ptr,t)}},{key:"seed",get:function(){return r.e(this.ptr)},set:function(t){r.A(this.ptr,t)}}],[{key:"__wrap",value:function(e){var n=Object.create(t.prototype);return n.ptr=e,n}},{key:"new",value:function(e,n,i,o,a,u){var c=r.hb(e,n,i,o,a,u);return t.__wrap(c)}}]),t}(),I=function(){function t(){i(this,t)}return a(t,[{key:"__destroy_into_raw",value:function(){var t=this.ptr;return this.ptr=0,t}},{key:"free",value:function(){var t=this.__destroy_into_raw();r.w(t)}},{key:"element",get:function(){return r.l(this.ptr)>>>0},set:function(t){r.H(this.ptr,t)}},{key:"friction",get:function(){try{var t=r.P(-16);r.n(t,this.ptr);var e=y()[t/4+0],n=g()[t/4+1];return 0===e?void 0:n}finally{r.P(16)}},set:function(t){r.J(this.ptr,!k(t),k(t)?0:t)}},{key:"restitution",get:function(){try{var t=r.P(-16);r.q(t,this.ptr);var e=y()[t/4+0],n=g()[t/4+1];return 0===e?void 0:n}finally{r.P(16)}},set:function(t){r.M(this.ptr,!k(t),k(t)?0:t)}},{key:"inertia",get:function(){try{var t=r.P(-16);r.o(t,this.ptr);var e=y()[t/4+0],n=g()[t/4+1];return 0===e?void 0:n}finally{r.P(16)}},set:function(t){r.K(this.ptr,!k(t),k(t)?0:t)}},{key:"velocity_x",get:function(){try{var t=r.P(-16);r.r(t,this.ptr);var e=y()[t/4+0],n=g()[t/4+1];return 0===e?void 0:n}finally{r.P(16)}},set:function(t){r.N(this.ptr,!k(t),k(t)?0:t)}},{key:"velocity_y",get:function(){try{var t=r.P(-16);r.s(t,this.ptr);var e=y()[t/4+0],n=g()[t/4+1];return 0===e?void 0:n}finally{r.P(16)}},set:function(t){r.O(this.ptr,!k(t),k(t)?0:t)}},{key:"falling",get:function(){var t=r.m(this.ptr);return 16777215===t?void 0:0!==t},set:function(t){r.I(this.ptr,k(t)?16777215:t?1:0)}},{key:"not_moved_count",get:function(){var t=r.p(this.ptr);return 16777215===t?void 0:t},set:function(t){r.L(this.ptr,k(t)?16777215:t)}}],[{key:"__wrap",value:function(e){var n=Object.create(t.prototype);return n.ptr=e,n}}]),t}(),S=function(){return function(t){s===u.length&&u.push(u.length+1);var e=s;return s=u[e],u[e]=t,e}(new Error)},T=function(t,e){var n=function(t,e,n){if(void 0===n){var r=b.encode(t),i=e(r.length);return h().subarray(i,i+r.length).set(r),_=r.length,i}for(var o=t.length,a=e(o),u=h(),c=0;c<o;c++){var s=t.charCodeAt(c);if(s>127)break;u[a+c]=s}if(c!==o){0!==c&&(t=t.slice(c)),a=n(a,o,o=c+3*t.length);var l=h().subarray(a+c,a+o);c+=x(t,l).written}return _=c,a}(c(e).stack,r.R,r.S),i=_;y()[t/4+1]=i,y()[t/4+0]=n},Y=function(t,e){try{console.error(p(t,e))}finally{r.Q(t,e)}},D=function(t){l(t)},X=function(t,e){throw new Error(p(t,e))}}).call(this,n(12)(t))},function(t,e,n){"use strict";var r=n.w[t.i];t.exports=r;n(9);r.jb()},,,,,function(t,e){t.exports="precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nvarying vec2 uv;\n\nvoid main() {\n    uv = position;\n    gl_Position = vec4(position, 0, 1);\n}"},function(t,e){t.exports="precision highp float;\n#define GLSLIFY 1\nuniform sampler2D map_texture;\nuniform sampler2D element_texture;\nuniform int element_count;\nvarying vec2 uv;\n\nvoid main() {\n    vec2 textCoord = (uv * vec2(0.5, -0.5)) + vec2(0.5);\n    vec4 pixel_info = texture2D(map_texture, textCoord);\n    int element = int((pixel_info.r * 255.) + 0.1);\n    vec4 color = texture2D(element_texture, vec2(float(element)/float(element_count),0));\n\n    gl_FragColor = color;\n}"},function(t,e){t.exports="precision mediump float;\n#define GLSLIFY 1\nattribute vec2 position;\nuniform float scale;\nuniform vec2 offset;\n\nvoid main () {\n    vec2 p  = position;\n    p *= scale;\n    p += offset;\n    gl_Position = vec4(p, 0, 1);\n}"},function(t,e){t.exports="precision mediump float;\n#define GLSLIFY 1\nuniform vec4 color;\n\nvoid main () {\n    gl_FragColor = color;\n}"},function(t,e,n){"use strict";n.r(e),n.d(e,"canvas",(function(){return _t})),n.d(e,"config",(function(){return kt})),n.d(e,"map",(function(){return tt})),n.d(e,"createMap",(function(){return bt})),n.d(e,"nextTick",(function(){return xt})),n.d(e,"generateSeed",(function(){return gt}));var r=n(9),i=[{key:r.a.Empty,value:{name:"Empty",color:[255,255,255,255]}},{key:r.a.Wall,value:{name:"Wall",color:[0,0,0,255]}},{key:r.a.Sand,value:{name:"Sand",color:[194,178,127,255]}},{key:r.a.Dirt,value:{name:"Dirt",color:[132,57,24,255]}},{key:r.a.Water,value:{name:"Water",color:[44,100,230,255]}}],o=[64,128,256,512],a=[16,32,64],u=[{key:r.d.EMPTY,value:{name:"Empty"}},{key:r.d.CAVE,value:{name:"Cave"}}],c=function(){var t=[];for(var e in i)i.hasOwnProperty(e)&&(t=t.concat(i[e].value.color));return t},s=document.getElementById("fps"),l=document.getElementById("meanRenderTime"),f=document.getElementById("meanTickTime"),v=document.getElementById("lastTickTime"),h=document.getElementById("meanPixelsProcessed"),p=document.getElementById("lastPixelsProcessed"),d={mean:0,delta:0,frames:[],lastFrameTimeStamp:performance.now(),measure:function(){var t=performance.now(),e=t-this.lastFrameTimeStamp;this.lastFrameTimeStamp=t;var n=1/e*1e3;this.delta=e/1e3,this.frames.push(n),this.frames.length>100&&this.frames.shift(),this.mean=g(this.frames)}},m={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){if(!window.paused){var t=performance.now()-this.startTime;this.last=t,this.frames.push(t),this.frames.length>100&&this.frames.shift(),this.mean=g(this.frames)}}},y={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){var t=performance.now()-this.startTime;this.last=t,v.textContent=window.paused?"".concat(Math.round(this.last),"ms"):"",this.frames.push(t),this.frames.length>100&&this.frames.shift(),this.mean=g(this.frames)}},w={mean:0,last:0,frames:[],measure:function(t){this.last=t,p.textContent=window.paused?"".concat(Math.round(this.last)," \n        (").concat(k(this.last,kt.size*kt.size),"%)"):"",this.frames.push(t),this.frames.length>10&&this.frames.shift(),this.mean=g(this.frames)},reset:function(){this.mean=0,this.last=0,this.frames=[]}},g=function(t){for(var e=0,n=0;n<t.length;n++)e+=t[n];return e/t.length},k=function(t,e){return Math.round(100*t/e)};setInterval((function(){s.textContent="FPS: ".concat(Math.round(d.mean)),l.textContent="".concat(Math.round(m.mean),"ms"),f.textContent="".concat(Math.round(y.mean),"ms"),h.textContent="".concat(Math.round(w.mean)," \n    (").concat(k(Math.round(w.mean),kt.size*kt.size),"%)")}),100);var _=n(13),b=document.getElementById("canvas");_("document").ready((function(){S(),T(),Y(),N(),I()}));var x=_("#create"),M=_("#generateSeed"),C=_("#configUseChunks"),E=_("#configChunkSize"),z=!1,P=_("#showActiveChunks");x.click((function(){kt.size=Number(_("#configSize").val()),kt.gravity=ft(_("#configGravity").val(),-1,1),kt.maxVelocity=ft(_("#configMaxVelocity").val(),0,100),kt.useChunks=C.is(":checked"),kt.chunkSize=Number(E.val()),kt.generator=function(t){for(var e in u)if(u.hasOwnProperty(e)&&u[e].value.name===t)return e;return null}(_("#configGenerator").val()),kt.seed=Number(_("#seed").val()),bt(),I()})),M.click((function(){kt.seed=gt(),I()}));var I=function(){_("#configSize").val(kt.size),_("#configGravity").val(kt.gravity),_("#configMaxVelocity").val(kt.maxVelocity),_("#configGenerator").val(u[kt.generator].value.name),_("#seed").val(kt.seed),C.prop("checked",kt.useChunks),E.val(kt.chunkSize),E.prop("disabled",!kt.useChunks)},S=function(){o.forEach((function(t){var e="<option>".concat(t,"</option>");_("#configSize").append(e)}))},T=function(){a.forEach((function(t){var e="<option>".concat(t,"</option>");_("#configChunkSize").append(e)}))},Y=function(){for(var t in u)if(u.hasOwnProperty(t)){var e="<option>".concat(u[t].value.name,"</option>");_("#configGenerator").append(e)}};C.change((function(){E.prop("disabled",!this.checked),P.prop("disabled",!this.checked)})),P.change((function(){z=this.checked}));var D=!1,X=_("#play"),F=_("#pause"),A=_("#nextFrame"),O=_("#reset");X.hide(),A.addClass("disabled"),X.click((function(){return R()})),F.click((function(){return R()})),A.click((function(){return L()})),O.click((function(){return V()})),_("body").keypress((function(t){112===t.keyCode?R():102===t.keyCode?L():114===t.keyCode&&V()}));var R=function(){D=!D,window.paused=D,D?(X.show(),F.hide(),A.removeClass("disabled")):(X.hide(),F.show(),A.addClass("disabled"))},L=function(){D&&(y.start(),w.measure(xt()),y.stop())},V=function(){tt.clear(),w.reset()},B=null,N=function(){var t=function(t){if(i.hasOwnProperty(t)){var e='\n                <div class="form-check">\n                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="element_'.concat(t,'">\n                    <label class="form-check-label" for="element_').concat(t,'">\n                        <i class="bi bi-square-fill" style="color: ').concat((n=t,"rgba("+i[n].value.color.join(",")+")"),'"></i>\n                        <label>').concat(i[t].value.name,"</label>\n                    </label>\n                </div>");_("#painting").append(e),_("#element_"+t).change((function(){return B=Number(t)}))}var n};for(var e in i)t(e);B=2,_("#element_2").attr("checked",!0)},W={value:0,step:1,min:0,max:5},j=_("#brushSize");j.on("change",(function(){W.value=ft(Number(_(this).val()),W.min,W.max)})),_(window).bind("mousewheel DOMMouseScroll",(function(t){t.originalEvent.wheelDelta>0||t.originalEvent.detail<0?(W.value=ft(W.value+W.step,W.min,W.max),j.val(W.value)):(W.value=ft(W.value-W.step,W.min,W.max),j.val(W.value))}));var G=null,q=!1,U=null,J=_("#inspectCheck"),H=_("#inspectDetails");H.hide(),J.click((function(){J.prop("checked")?(q=!0,clearInterval(U),U=window.setInterval((function(){return K()}),100)):(q=!1,clearInterval(U))}));var K=function(){if(q&&G){var t=tt.pixel_info(G[0],G[1]);t&&(H.show(),_("#inspectElement").text(i[t.element].value.name),_("#inspectPosition").text("("+G[0]+", "+G[1]+")"),void 0!==t.velocity_x&&void 0!==t.velocity_y?(_("#inspectVelocity").text("("+t.velocity_x+", "+t.velocity_y+")"),_("#inspectVelocityRow").show()):_("#inspectVelocityRow").hide(),void 0!==t.falling?(_("#inspectFalling").text(t.falling),_("#inspectFallingRow").show()):_("#inspectFallingRow").hide(),void 0!==t.not_moved_count?(_("#inspectNotMovedCount").text(t.not_moved_count),_("#inspectNotMovedCountRow").show()):_("#inspectNotMovedCountRow").hide())}else H.hide()},Q=!1,Z=null,$=null;b.addEventListener("mousedown",(function(t){t.preventDefault(),Q=!0,clearInterval($),$=window.setInterval((function(){return nt(t)}),100),nt(t),Z=t})),document.body.addEventListener("mouseup",(function(t){clearInterval($),Q&&(t.preventDefault(),Z=null,Q=!1)})),b.addEventListener("mousemove",(function(t){clearInterval($),rt(t),function(t){G=J.prop("checked")?it(t):null}(t)})),b.addEventListener("mouseleave",(function(){clearInterval($),Z=null,G=null}));var tt,et,nt=function(t){if(Q){var e=it(t);tt.insert(e[0],e[1],B,W.value)}},rt=function(t){clearInterval($),$=window.setInterval((function(){return nt(t)}),100);var e={clientX:t.clientX,clientY:t.clientY};if(Q){var n=0;if(nt(e),Z)for(;ot(e,Z)>1/3;){var r=ot(e,Z);if(e=at(e,st(ct(ut(Z,t)),Math.min(1/3,r))),++n>1e3)break;nt(e)}Z=t}},it=function(t){var e=b.getBoundingClientRect(),n=b.width/Math.ceil(window.devicePixelRatio)/e.width,r=b.height/Math.ceil(window.devicePixelRatio)/e.height,i=(t.clientX-e.left)*n,o=(t.clientY-e.top)*r;return[Math.max(Math.min(Math.floor(i),kt.size-1),0),Math.max(Math.min(Math.floor(o),kt.size-1),0)]},ot=function(t,e){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2),2)},at=function(t,e){return{clientX:t.clientX+e.clientX,clientY:t.clientY+e.clientY}},ut=function(t,e){return{clientX:t.clientX-e.clientX,clientY:t.clientY-e.clientY}},ct=function(t){var e=lt(t);return{clientX:t.clientX/e,clientY:t.clientY/e}},st=function(t,e){return{clientX:t.clientX*e,clientY:t.clientY*e}},lt=function(t){return Math.sqrt(Math.pow(t.clientX,2)+Math.pow(t.clientY,2),2)},ft=function(t,e,n){return Math.min(Math.max(t,e),n)},vt=n(10),ht=n(14),pt=n(15),dt=n(16),mt=n(17),yt=n(18),wt=function(t){var e=t.canvas,n=t.map,r=t.config,o=ht({canvas:e}),a=n.config().size,u=o.texture({width:i.length,height:1,type:"uint8",format:"rgba",data:new Uint8Array(c())}),s=o.texture({width:a,height:a,type:"uint8",format:"rgba",data:new Uint8Array(vt.ib.buffer,n.display(),a*a*4)}),l=o({vert:pt,frag:dt,uniforms:{element_texture:u,element_count:i.length,map_texture:function(){return s({width:a,height:a,data:new Uint8Array(vt.ib.buffer,n.display(),a*a*4)})}},attributes:{position:[[-1,4],[-1,-1],[4,-1]]},count:3}),f=o({vert:mt,frag:yt,attributes:{position:[[-1,-1],[1,-1],[1,1],[-1,1]]},uniforms:{color:[0,1,0,1],scale:o.prop("scale"),offset:o.prop("offset")},count:4,lineWidth:1,primitive:"line loop"}),v=function(){var t=[];if(r.useChunks)for(var e=r.chunkSize/a,i=0;i<n.chunks_count();i++){var o=n.chunk(i);t.push({scale:e,offset:[-1+e+o.x()/r.size*2,1-e-o.y()/r.size*2]})}return t}(),h=function(){r.useChunks&&z&&f(v.filter((function(t,e){return n.chunk(e).active_next_tick()})))};return function(){o.poll(),h(),l()}},gt=function(){return Math.floor(Math.random()*Math.floor(1e4))},kt={size:256,gravity:.2,maxVelocity:10,useChunks:!0,chunkSize:32,generator:r.d.EMPTY,seed:1},_t=document.getElementById("canvas"),bt=function(){tt=r.b.new(r.c.new(kt.size,kt.gravity,kt.maxVelocity,kt.useChunks,kt.chunkSize,kt.seed),Number(kt.generator)),_t.width=kt.size*Math.ceil(window.devicePixelRatio),_t.height=kt.size*Math.ceil(window.devicePixelRatio),et=wt({canvas:_t,map:tt,config:kt}),w.reset()};bt();var xt=function(){return tt.tick(d.delta)};!function t(){d.measure(),window.paused||(y.start(),w.measure(xt()),y.stop()),m.start(),et(),m.stop(),window.animationId=requestAnimationFrame(t)}()}]]);
//# sourceMappingURL=1.e3044afba7548fa6370c.js.map