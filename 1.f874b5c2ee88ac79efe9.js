(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{10:function(e,t,n){"use strict";var r=n.w[e.i];e.exports=r;n(9);r.P()},15:function(e,t,n){"use strict";n.r(t),n.d(t,"canvas",(function(){return me})),n.d(t,"config",(function(){return de})),n.d(t,"map",(function(){return $})),n.d(t,"createMap",(function(){return ye})),n.d(t,"nextTick",(function(){return we})),n.d(t,"generateSeed",(function(){return pe}));var r=n(9),i=[{key:r.a.Empty,value:{name:"Empty",color:"rgba(255,255,255,1)"}},{key:r.a.Wall,value:{name:"Wall",color:"rgba(0,0,0,1)"}},{key:r.a.Sand,value:{name:"Sand",color:"rgba(194, 178, 127, 1)"}}],a=[64,128,256,512],o=[16,32,64],u=[{key:r.d.EMPTY,value:{name:"Empty"}},{key:r.d.CAVE,value:{name:"Cave"}}],c=document.getElementById("fps"),s=document.getElementById("meanRenderTime"),l=document.getElementById("meanTickTime"),f=document.getElementById("lastTickTime"),v=document.getElementById("meanPixelsProcessed"),h=document.getElementById("lastPixelsProcessed"),p={mean:0,delta:0,frames:[],lastFrameTimeStamp:performance.now(),measure:function(){var e=performance.now(),t=e-this.lastFrameTimeStamp;this.lastFrameTimeStamp=e;var n=1/t*1e3;this.delta=t/1e3,this.frames.push(n),this.frames.length>100&&this.frames.shift(),this.mean=w(this.frames)}},d={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){if(!window.paused){var e=performance.now()-this.startTime;this.last=e,this.frames.push(e),this.frames.length>100&&this.frames.shift(),this.mean=w(this.frames)}}},m={mean:0,last:0,frames:[],startTime:performance.now(),start:function(){this.startTime=performance.now()},stop:function(){var e=performance.now()-this.startTime;this.last=e,f.textContent=window.paused?"".concat(Math.round(this.last),"ms"):"",this.frames.push(e),this.frames.length>100&&this.frames.shift(),this.mean=w(this.frames)}},y={mean:0,last:0,frames:[],measure:function(e){this.last=e,h.textContent=window.paused?"".concat(Math.round(this.last)," \n        (").concat(k(this.last,de.size*de.size),"%)"):"",this.frames.push(e),this.frames.length>10&&this.frames.shift(),this.mean=w(this.frames)},reset:function(){this.mean=0,this.last=0,this.frames=[]}},w=function(e){for(var t=0,n=0;n<e.length;n++)t+=e[n];return t/e.length},k=function(e,t){return Math.round(100*e/t)};setInterval((function(){c.textContent="FPS: ".concat(Math.round(p.mean)),s.textContent="".concat(Math.round(d.mean),"ms"),l.textContent="".concat(Math.round(m.mean),"ms"),v.textContent="".concat(Math.round(y.mean)," \n    (").concat(k(Math.round(y.mean),de.size*de.size),"%)")}),100);var _=n(13),g=document.getElementById("canvas");_("document").ready((function(){I(),S(),P(),J(),T()}));var b=_("#create"),x=_("#generateSeed"),M=_("#configUseChunks"),C=_("#configChunkSize"),E=!1,z=_("#showActiveChunks");b.click((function(){de.size=Number(_("#configSize").val()),de.gravity=le(_("#configGravity").val(),-1,1),de.maxVelocity=le(_("#configMaxVelocity").val(),0,100),de.useChunks=M.is(":checked"),de.chunkSize=Number(C.val()),de.generator=function(e){for(var t in u)if(u.hasOwnProperty(t)&&u[t].value.name===e)return t;return null}(_("#configGenerator").val()),de.seed=Number(_("#seed").val()),ye(),T()})),x.click((function(){de.seed=pe(),T()}));var T=function(){_("#configSize").val(de.size),_("#configGravity").val(de.gravity),_("#configMaxVelocity").val(de.maxVelocity),_("#configGenerator").val(u[de.generator].value.name),_("#seed").val(de.seed),M.prop("checked",de.useChunks),C.val(de.chunkSize),C.prop("disabled",!de.useChunks)},I=function(){a.forEach((function(e){var t="<option>".concat(e,"</option>");_("#configSize").append(t)}))},S=function(){o.forEach((function(e){var t="<option>".concat(e,"</option>");_("#configChunkSize").append(t)}))},P=function(){for(var e in u)if(u.hasOwnProperty(e)){var t="<option>".concat(u[e].value.name,"</option>");_("#configGenerator").append(t)}};M.change((function(){C.prop("disabled",!this.checked),z.prop("disabled",!this.checked)})),z.change((function(){E=this.checked}));var Y=!1,X=_("#play"),O=_("#pause"),A=_("#nextFrame"),D=_("#reset");X.hide(),A.addClass("disabled"),X.click((function(){return B()})),O.click((function(){return B()})),A.click((function(){return F()})),D.click((function(){return V()})),_("body").keypress((function(e){112===e.keyCode?B():102===e.keyCode?F():114===e.keyCode&&V()}));var B=function(){Y=!Y,window.paused=Y,Y?(X.show(),O.hide(),A.removeClass("disabled")):(X.hide(),O.show(),A.addClass("disabled"))},F=function(){Y&&(m.start(),y.measure(we()),m.stop())},V=function(){$.clear(),y.reset()},j=null,J=function(){var e=function(e){if(i.hasOwnProperty(e)){var t='\n                <div class="form-check">\n                    <input class="form-check-input" type="radio" name="flexRadioDefault" id="element_'.concat(e,'">\n                    <label class="form-check-label" for="element_').concat(e,'">\n                        <i class="bi bi-square-fill" style="color: ').concat(i[e].value.color,'"></i>\n                        <label>').concat(i[e].value.name,"</label>\n                    </label>\n                </div>");_("#painting").append(t),_("#element_"+e).change((function(){return j=Number(e)}))}};for(var t in i)e(t);j=2,_("#element_2").attr("checked",!0)},N={value:0,step:1,min:0,max:5},q=_("#brushSize");q.on("change",(function(){N.value=le(Number(_(this).val()),N.min,N.max)})),_(window).bind("mousewheel DOMMouseScroll",(function(e){e.originalEvent.wheelDelta>0||e.originalEvent.detail<0?(N.value=le(N.value+N.step,N.min,N.max),q.val(N.value)):(N.value=le(N.value-N.step,N.min,N.max),q.val(N.value))}));var R=null,G=!1,L=null,W=_("#inspectCheck"),U=_("#inspectDetails");U.hide(),W.click((function(){W.prop("checked")?(G=!0,clearInterval(L),L=window.setInterval((function(){return H()}),100)):(G=!1,clearInterval(L))}));var H=function(e){if(G&&R){var t=$.pixel_state(R[0],R[1]);t&&(U.show(),_("#inspectElement").text(i[t.element()].value.name),_("#inspectPosition").text("("+R[0]+", "+R[1]+")"),_("#inspectVelocity").text("(0, "+t.velocity_y()+")"),_("#inspectFalling").text(t.falling()),_("#inspectNotMovedCount").text(t.not_moved_count()))}else U.hide()},K=!1,Q=null,Z=null;g.addEventListener("mousedown",(function(e){e.preventDefault(),K=!0,clearInterval(Z),Z=window.setInterval((function(){return te(e)}),100),te(e),Q=e})),document.body.addEventListener("mouseup",(function(e){clearInterval(Z),K&&(e.preventDefault(),Q=null,K=!1)})),g.addEventListener("mousemove",(function(e){clearInterval(Z),ne(e),function(e){R=W.prop("checked")?re(e):null}(e)})),g.addEventListener("mouseleave",(function(e){clearInterval(Z),Q=null,R=null}));var $,ee,te=function(e){if(K){var t=re(e);$.insert(t[0],t[1],j,N.value)}},ne=function(e){clearInterval(Z),Z=window.setInterval((function(){return te(e)}),100);var t={clientX:e.clientX,clientY:e.clientY};if(K){var n=0;if(te(t),Q)for(;ie(t,Q)>1/3;){var r=ie(t,Q);if(t=ae(t,ce(ue(oe(Q,e)),Math.min(1/3,r))),++n>1e3)break;te(t)}Q=e}},re=function(e){var t=g.getBoundingClientRect(),n=g.width/Math.ceil(window.devicePixelRatio)/t.width,r=g.height/Math.ceil(window.devicePixelRatio)/t.height,i=(e.clientX-t.left)*n,a=(e.clientY-t.top)*r;return[Math.max(Math.min(Math.floor(i),de.size-1),0),Math.max(Math.min(Math.floor(a),de.size-1),0)]},ie=function(e,t){return Math.sqrt(Math.pow(e.clientX-t.clientX,2)+Math.pow(e.clientY-t.clientY,2),2)},ae=function(e,t){return{clientX:e.clientX+t.clientX,clientY:e.clientY+t.clientY}},oe=function(e,t){return{clientX:e.clientX-t.clientX,clientY:e.clientY-t.clientY}},ue=function(e){var t=se(e);return{clientX:e.clientX/t,clientY:e.clientY/t}},ce=function(e,t){return{clientX:e.clientX*t,clientY:e.clientY*t}},se=function(e){return Math.sqrt(Math.pow(e.clientX,2)+Math.pow(e.clientY,2),2)},le=function(e,t,n){return Math.min(Math.max(e,t),n)},fe=n(10),ve=n(14),he=function(e){var t=e.canvas,n=e.map,r=e.config,i=ve({canvas:t}),a=n.size(),o=n.pixels(),u=new Uint8Array(fe.J.buffer,o,a*a*4),c=i.texture({width:a,height:a,data:u}),s=i({frag:"\n        precision highp float;\n        uniform sampler2D data;\n        varying vec2 uv;\n        void main() {\n            vec2 textCoord = (uv * vec2(0.5, -0.5)) + vec2(0.5);\n            vec4 data = texture2D(data, textCoord);\n            int element = int((data.r * 255.) + 0.1);\n            vec4 color;\n            \n            // empty\n            if (element == 0) {\n                color = vec4(255, 255, 255, 1);\n            }\n            \n            if (element == 1) {\n                color = vec4(0, 0, 0, 1);\n            }\n            \n            // sand\n            if (element == 2) {\n                color = vec4(0.76, 0.7, 0.5, 1);\n            }\n            \n            gl_FragColor = color;\n        }",vert:"\n        precision mediump float;\n        attribute vec2 position;\n        varying vec2 uv;\n        void main() {\n            uv = position;\n            gl_Position = vec4(position, 0, 1);\n        }",uniforms:{data:function(){return o=n.pixels(),u=new Uint8Array(fe.J.buffer,o,a*a*4),c({width:a,height:a,data:u})}},attributes:{position:[[-1,4],[-1,-1],[4,-1]]},count:3});var l,f=[];if(r.useChunks)for(var v=r.chunkSize/n.size(),h=0;h<n.chunks_count();h++){var p=n.chunk(h);f.push((l={scale:v,offset:[-1+v+p.x()/r.size*2,1-v-p.y()/r.size*2]},i({frag:"\n            precision mediump float;\n            uniform vec4 color;\n            void main () {\n              gl_FragColor = color;\n            }",vert:"\n            precision mediump float;\n            attribute vec2 position;\n            uniform float scale;\n            uniform vec2 offset;\n            void main () {\n              vec2 p  = position;\n              p *= scale;\n              p += offset;\n              gl_Position = vec4(p, 0, 1);\n            }",attributes:{position:[[-1,-1],[1,-1],[1,1],[-1,1]]},uniforms:{color:[0,1,0,1],scale:l.scale,offset:l.offset},count:4,lineWidth:1,primitive:"line loop"})))}return function(){i.poll(),function(){if(r.useChunks&&E)for(var e=0;e<f.length;e++){n.chunk(e).active_next_tick()&&f[e]()}}(),s()}},pe=function(){return Math.floor(Math.random()*Math.floor(1e4))},de={size:256,gravity:.2,maxVelocity:10,useChunks:!0,chunkSize:32,generator:r.d.EMPTY,seed:1},me=document.getElementById("canvas"),ye=function(){$=r.b.new(r.c.new(de.size,de.gravity,de.maxVelocity,de.useChunks,de.chunkSize,de.seed),Number(de.generator)),me.width=de.size*Math.ceil(window.devicePixelRatio),me.height=de.size*Math.ceil(window.devicePixelRatio),ee=he({canvas:me,map:$,config:de}),y.reset()};ye();var we=function(){return $.tick(p.delta)};!function e(){p.measure(),window.paused||(m.start(),y.measure(we()),m.stop()),d.start(),ee(),d.stop(),window.animationId=requestAnimationFrame(e)}()},9:function(e,t,n){"use strict";(function(e){n.d(t,"d",(function(){return g})),n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return M})),n.d(t,"c",(function(){return C})),n.d(t,"f",(function(){return T})),n.d(t,"g",(function(){return I})),n.d(t,"e",(function(){return S})),n.d(t,"h",(function(){return P})),n.d(t,"i",(function(){return Y}));var r=n(10);function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function a(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&a(e.prototype,t),n&&a(e,n),e}var u=new Array(32).fill(void 0);function c(e){return u[e]}u.push(void 0,null,!0,!1);var s=u.length;function l(e){var t=c(e);return function(e){e<36||(u[e]=s,s=e)}(e),t}var f=new("undefined"==typeof TextDecoder?(0,e.require)("util").TextDecoder:TextDecoder)("utf-8",{ignoreBOM:!0,fatal:!0});f.decode();var v=null;function h(){return null!==v&&v.buffer===r.J.buffer||(v=new Uint8Array(r.J.buffer)),v}function p(e,t){return f.decode(h().subarray(e,e+t))}function d(e,t){if(!(e instanceof t))throw new Error("expected instance of ".concat(t.name));return e.ptr}var m=0,y=new("undefined"==typeof TextEncoder?(0,e.require)("util").TextEncoder:TextEncoder)("utf-8"),w="function"==typeof y.encodeInto?function(e,t){return y.encodeInto(e,t)}:function(e,t){var n=y.encode(e);return t.set(n),{read:e.length,written:n.length}};var k=null;function _(){return null!==k&&k.buffer===r.J.buffer||(k=new Int32Array(r.J.buffer)),k}var g=Object.freeze({EMPTY:0,0:"EMPTY",CAVE:1,1:"CAVE"}),b=Object.freeze({Empty:0,0:"Empty",Wall:1,1:"Wall",Sand:2,2:"Sand"}),x=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.a(e)}},{key:"x",value:function(){return r.f(this.ptr)}},{key:"y",value:function(){return r.w(this.ptr)}},{key:"active",value:function(){return 0!==r.u(this.ptr)}},{key:"active_next_tick",value:function(){return 0!==r.v(this.ptr)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}}]),e}(),M=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.h(e)}},{key:"insert",value:function(e,t,n,i){r.A(this.ptr,e,t,n,i)}},{key:"clear",value:function(){r.z(this.ptr)}},{key:"tick",value:function(){return r.H(this.ptr)>>>0}},{key:"size",value:function(){return r.f(this.ptr)}},{key:"pixels",value:function(){return r.G(this.ptr)}},{key:"pixel",value:function(e,t){var n=r.E(this.ptr,e,t);return E.__wrap(n)}},{key:"pixel_state",value:function(e,t){var n=r.F(this.ptr,e,t);return z.__wrap(n)}},{key:"chunk",value:function(e){var t=r.x(this.ptr,e);return x.__wrap(t)}},{key:"chunks_count",value:function(){return r.y(this.ptr)>>>0}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new_empty",value:function(t){d(t,C);var n=t.ptr;t.ptr=0;var i=r.D(n);return e.__wrap(i)}},{key:"new_cave",value:function(t){d(t,C);var n=t.ptr;t.ptr=0;var i=r.C(n);return e.__wrap(i)}},{key:"new",value:function(t,n){d(t,C);var i=t.ptr;t.ptr=0;var a=r.B(i,n);return e.__wrap(a)}}]),e}(),C=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.i(e)}},{key:"size",get:function(){return r.f(this.ptr)},set:function(e){r.p(this.ptr,e)}},{key:"gravity",get:function(){return r.c(this.ptr)},set:function(e){r.m(this.ptr,e)}},{key:"max_velocity",get:function(){return r.d(this.ptr)},set:function(e){r.n(this.ptr,e)}},{key:"use_chunks",get:function(){return 0!==r.g(this.ptr)},set:function(e){r.q(this.ptr,e)}},{key:"chunk_size",get:function(){return r.b(this.ptr)},set:function(e){r.l(this.ptr,e)}},{key:"seed",get:function(){return r.e(this.ptr)},set:function(e){r.o(this.ptr,e)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(t,n,i,a,o,u){var c=r.I(t,n,i,a,o,u);return e.__wrap(c)}}]),e}(),E=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.j(e)}},{key:"element",value:function(){return r.K(this.ptr)>>>0}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(t){var n=r.L(t);return e.__wrap(n)}}]),e}(),z=function(){function e(){i(this,e)}return o(e,[{key:"__destroy_into_raw",value:function(){var e=this.ptr;return this.ptr=0,e}},{key:"free",value:function(){var e=this.__destroy_into_raw();r.k(e)}},{key:"element",value:function(){return r.M(this.ptr)>>>0}},{key:"velocity_y",value:function(){return r.c(this.ptr)}},{key:"falling",value:function(){return 0!==r.u(this.ptr)}},{key:"not_moved_count",value:function(){return r.O(this.ptr)}}],[{key:"__wrap",value:function(t){var n=Object.create(e.prototype);return n.ptr=t,n}},{key:"new",value:function(t){var n=r.N(t);return e.__wrap(n)}}]),e}(),T=function(){return function(e){s===u.length&&u.push(u.length+1);var t=s;return s=u[t],u[t]=e,t}(new Error)},I=function(e,t){var n=function(e,t,n){if(void 0===n){var r=y.encode(e),i=t(r.length);return h().subarray(i,i+r.length).set(r),m=r.length,i}for(var a=e.length,o=t(a),u=h(),c=0;c<a;c++){var s=e.charCodeAt(c);if(s>127)break;u[o+c]=s}if(c!==a){0!==c&&(e=e.slice(c)),o=n(o,a,a=c+3*e.length);var l=h().subarray(o+c,o+a);c+=w(e,l).written}return m=c,o}(c(t).stack,r.s,r.t),i=m;_()[e/4+1]=i,_()[e/4+0]=n},S=function(e,t){try{console.error(p(e,t))}finally{r.r(e,t)}},P=function(e){l(e)},Y=function(e,t){throw new Error(p(e,t))}}).call(this,n(12)(e))}}]);
//# sourceMappingURL=1.f874b5c2ee88ac79efe9.js.map